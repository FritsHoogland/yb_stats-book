# Statement statistics

In the output generated by ad-hoc or snapshot-diff mode, a fourth group that optionally can be shown are statement statistics. These statistics are taken from the YSQL (normally port 13000) http endpoint. If no SQL interaction did happen between YSQL/postgres and DocDB, then there will be no statements shown.

This is how the statement output looks like:
```
192.168.66.80:13000           1 avg:          18.552 tot:          18.552 ms avg:          1 tot:          1 rows: insert into t values ($1, $2)
```
- The first column contains the ip address or hostname a colon and the port number.
- The second column contains the number of calls of this SQL statement, where the number of calls is the difference of the number of calls between the END and BEGIN snapshots.
- The third column (skipping counting 'avg:' ) is the average total_time per call, which is calculated as the difference of the total_time between the END and BEGIN snapshots divided by the difference of the number of calls between the END and BEGIN snapshots.
- The fourth column (skipping counting 'tot:') is the total_time, which is calculated as the difference of the total_time between the END and BEGIN snapshots.
- The fifth column (skipping counting 'ms avg:') is the average number of rows, which is calculated as the difference of rows between END and BEGIN snapshots divided by the difference in calls between the END and BEGIN snapshots.
- The sixth column (skipping counting 'tot:') is the total number of rows, which is calculated as the difference of rows between END and BEGIN snapshots.
- The seventh column (skipping counting 'rows:' is the SQL statement. Th maximal length of the SQL statement shown is 80 characters, and can be changed by the `--sql-length` parameter and a number.

For the sake of simplicity, any identical SQL (based on the query text) is summed up, and assumed to be the same statement. This is not correct. (at the time of creation, query_id was not exposed, so this was the only solution)

Please mind the source of the SQL statistics is postgres' pg_stat_statements, and holds a few quirks:
- Any SQL that returns an error is not saved in 'pg_stat_statements'.
- The 'total_time' is actually the time spent in the *execution phase*. Especially since YSQL might need to perform RPCs to complete its catalog (in rewrite/semantic parse and plan phases), this can miss some time and therefore show less time than a client sees.
- A statement's uniqueness in pg_stat_statements is dependent on query_id, dbid and userid. Currently we don expose all this fields in the http endpoint.
